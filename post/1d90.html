<!-- build time:Fri Mar 06 2020 23:20:19 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><title itemprop="name">【TensorFlow&amp;Keras】入门猫狗数据集实验--理解卷积神经网络CNN | cungudafa</title><link rel="shortcut icon" href="/images/favicon.ico"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+SerifMerriweather|Merriweather+Sans|Source+Code+Pro|Ubuntu:400,700|Noto+Serif+SC" media="all"><link rel="dns-prefetch" href="//cdn.jsdelivr.net"><link rel="stylesheet" id="saukra_css-css" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/style.css" type="text/css" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/lib.min.css" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/font.css" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/insight.css" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/tags.css" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/jquery.fancybox.min.css" media="all"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/sharejs.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/logo.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/fonts/LOGO/logo.css"><script>var mashiro_option=new Object,mashiro_global=new Object;mashiro_option.NProgressON=!0,mashiro_option.email_domain="",mashiro_option.email_name="",mashiro_option.cookie_version_control="",mashiro_option.qzone_autocomplete=!1,mashiro_option.site_name="cungudafa姑",mashiro_option.author_name="姑",mashiro_option.site_url="https://cungudafa.gitee.io/",mashiro_option.v_appId="cBzr9TtJ0xY0s6f3H8bpmB3M-gzGzoHsz",mashiro_option.v_appKey="3opMyv2Vyx3mHa0IWitRGSoi",mashiro_option.mathjax="0",mashiro_option.qq_api_url="https://api.mashiro.top/qqinfo/",mashiro_option.qq_avatar_api_url="https://api.mashiro.top/qqinfo/"</script><script type="text/javascript">var bg="https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(0).jpg.webp,https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(1).jpg.webp,https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(2).jpg.webp,https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(3).jpg.webp,https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(4).jpg.webp,https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(5).jpg.webp,https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(6).jpg.webp,https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(7).jpg.webp".split(","),bgindex=Math.floor(Math.random()*bg.length);(window.ActiveXObject||"ActiveXObject"in window)&&alert("朋友，IE浏览器未适配哦~")</script><style type="text/css">.hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}</style><style type="text/css">.site-top .lower nav{display:block!important}#pagination a:hover,.author-profile i,.float-content i:hover,.post-content a:hover,.post-like a,.post-more i:hover,.post-share .show-share,.sub-text,.we-info a,span.sitename{color:#FE9600}.ar-time i,.comment .comment-reply-link,.download,.feature i,.links ul li:before,.navigator i:hover,.object,.siren-checkbox-radio:checked+.siren-checkbox-radioInput:after,span.ar-circle{background:#FE9600}::-webkit-scrollbar-thumb{background:#FE9600}#pagination a:hover,.comment-respond input[type=submit]:hover,.download,.link-title,.links ul li:hover,.navigator i:hover{border-color:#FE9600}#archives-temp h3,#comments-navi a.next,#comments-navi a.prev,.comment h4 a,.comment h4 a:hover,.comment-respond input[type=submit]:hover,.entry-content a:hover,.entry-title a:hover,.site-info a:hover,.site-title a:hover,.site-top ul li a:hover,.sorry li a:hover,i.iconfont.js-toggle-search.iconsearch:hover,span.page-numbers.current{color:#FE9600}.comments .comments-main{display:block!important}.comments .comments-hidden{display:none!important;background-position:center;background-attachment:inherit}</style><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="cungudafa" type="application/atom+xml"></head></html><body class="page-template page-template-user page-template-page-analytics page-template-userpage-analytics-php page page-id-1297 chinese-font serif isWebKit"><div class="scrollbar" id="bar"></div><a href="#" class="cd-top faa-float animated"></a><section id="main-container"><div class="headertop filter-dot"><div id="banner_wave_1"></div><div id="banner_wave_2"></div><figure id="centerbg" class="centerbg"><div class="focusinfo no-select"><div class="header-tou"><a href="https://cungudafa.gitee.io/"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/custom/cungudafa.jpg"></a></div><div class="header-info"><p>莫三天打鱼两天晒网</p><div class="top-social_v2"><li id="bg-pre"><img class="flipx" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg"></li><li><a href="https://gitee.com/cungudafa" target="_blank" class="social-github" title="gitee"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/social/gitee.png"></a></li><li><a href="http://github.com/cungudafa" target="_blank" class="social-github" title="github"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/social/github.png"></a></li><li><a href="https://blog.csdn.net/cungudafa" target="_blank" class="social-github" title="csdn"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/social/csdn.png"></a></li><li><a href="https://www.zhihu.com/people/cungudafa" target="_blank" class="social-github" title="zhihu"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/social/zhihu.png"></a></li><li><a href="/https://www.jianshu.com/u/9b726a534140" target="_blank" class="social-github" title="jianshu"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/social/jianshu.png"></a></li><li><a href="https://space.bilibili.com/430247358" target="_blank" class="social-github" title="bilibili"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/social/bilibili.png"></a></li><li><a href="https://music.163.com/#/user/home?id=337394988" target="_blank" class="social-github" title="wangyiyun"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/social/wangyiyun.png"></a></li><li class="wechat"><a href="/#"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/social/wechat.png"></a><div class="wechatInner"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/custom/cungudafa.png"></div></li><li id="bg-next"><img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg"></li></div></div></div></figure><div id="video-container"><video style="object-fit:fill" id="bgvideo" class="video" video-name="" src="" width="auto" preload="auto"></video><div id="video-btn" class="loadvideo videolive"></div><div id="video-add"></div><div class="video-stu"></div></div><div class="headertop-down faa-float animated" onclick="headertop_down()"><span><i class="fa fa-chevron-down" aria-hidden="true"></i></span></div></div><div id="page" class="site wrapper"><header class="site-header no-select gizle sabit" role="banner"><div class="site-top"><div class="site-branding"><span class="site-title"><span class="logolink logo"><a href="/"><ruby><span class="sakuraso">姑</span> <span class="no">の</span> <span class="shironeko">小屋</span> <rp></rp> <rt class="logo">cungudafa</rt> <rp></rp></ruby></a></span></span></div><div class="searchbox search-form-submit"><i class="iconfont js-toggle-search iconsearch icon-search"></i></div><div id="show-nav" class="showNav mobile-fit"><div class="line line1"></div><div class="line line2"></div><div class="line line3"></div></div><div class="lower-cantiner"><div class="lower"><nav class="mobile-fit-control hide"><ul id="menu-new" class="menu"><li><a href="/"><span class="faa-parent animated-hover"><i class="fa fa-fort-awesome faa-shake" aria-hidden="true"></i> 首页</span></a></li><li><a href="/archives"><span class="faa-parent animated-hover"><i class="fa fa-archive faa-shake" aria-hidden="true"></i> 归档</span></a><ul class="sub-menu"><li><a href="/tags"><i class="fa fa-tags" aria-hidden="true"></i> 标签</a></li><li><a href="/categories/%E6%8A%80%E6%9C%AF/"><i class="fa fa-code" aria-hidden="true"></i> 技术</a></li><li><a href="/categories/%E7%94%9F%E6%B4%BB/"><i class="fa fa-file-text-o" aria-hidden="true"></i> 生活</a></li></ul></li><li><a href="javascript:;"><span class="faa-parent animated-hover"><i class="fa fa-list-ul faa-vertical" aria-hidden="true"></i> 清单</span></a><ul class="sub-menu"><li><a href="/photos/"><i class="fa fa-photo" aria-hidden="true"></i> 相册</a></li><li><a href="/shuoshuo/"><i class="fa fa-commenting-o fa-commenting" aria-hidden="true"></i> 说说</a></li><li><a href="/bangumi/"><i class="fa fa-film faa-vertical" aria-hidden="true"></i> 番组</a></li><li><a href="/music/"><i class="fa fa-headphones" aria-hidden="true"></i> 歌单</a></li></ul></li><li><a href="/comment/"><span class="faa-parent animated-hover"><i class="fa fa-pencil-square-o faa-tada" aria-hidden="true"></i> 留言板</span></a></li><li><a href="/links/"><span class="faa-parent animated-hover"><i class="fa fa-link faa-shake" aria-hidden="true"></i> 友人帐</span></a></li><li><a href="/donate/"><span class="faa-parent animated-hover"><i class="fa fa-heart faa-pulse" aria-hidden="true"></i> 赞赏</span></a></li><li><a href="/"><span class="faa-parent animated-hover"><i class="fa fa-leaf faa-wrench" aria-hidden="true"></i> 关于</span></a><ul class="sub-menu"><li><a href="/about/"><i class="fa fa-meetup" aria-hidden="true"></i> 我？</a></li><li><a href="/theme-sakura/"><i class="fa iconfont icon-sakura" aria-hidden="true"></i> 主题</a></li><li><a href="/lab/"><i class="fa fa-cogs" aria-hidden="true"></i> Lab</a></li></ul></li><li><a href="/client/"><span class="faa-parent animated-hover"><i class="fa fa-android faa-vertical" aria-hidden="true"></i> 项目</span></a></li><li><a href="/atom.xml"><span class="faa-parent animated-hover"><i class="fa fa-rss faa-pulse" aria-hidden="true"></i> RSS</span></a></li></ul></nav></div></div></div></header><link rel="stylesheet" type="text/css" href="/css/sharejs.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css"><div class="pattern-center-blank"></div><div class="pattern-center single-center"><div class="pattern-attachment-img lazyload" style="background-image:url(https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=4190080762,256915529&amp;fm=26&amp;gp=0.jpg)" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=4190080762,256915529&amp;fm=26&amp;gp=0.jpg"></div><header class="pattern-header single-header"><h1 class="entry-title">【TensorFlow&Keras】入门猫狗数据集实验--理解卷积神经网络CNN</h1><p class="entry-census"><span class="post-meta-item"><a href="https://cungudafa.gitee.io"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/custom/cungudafa.jpg"> </a></span><span class="post-meta-item"><a href="https://cungudafa.gitee.io">cungudafa </a></span><span class="bull">·</span> <span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar"></i> </span><span class="post-meta-item-text">2020-3-1 </span></span><span class="bull">·</span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="iconfont icon-attention"></i> </span><span class="post-meta-item-text">本文共<span id="busuanzi_value_page_pv"> </span>次阅读 </span></span><span class="bull">·</span><span class="post-meta-item"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-book"></i> <span class="post-meta-item-text">字数统计: </span><span class="post-count">3.3k字</span> </span></span><span class="bull">·</span> <span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> <span class="post-meta-item-text">阅读时长≈</span> <span class="post-count">14分钟</span></span></span> </span><span class="bull">·</span></p></header></div><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main" role="main"><article id="post-1" class="post-1 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized"><div class="toc"></div><div class="entry-content"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><strong>1、TensorFlow&amp;Keras环境配置</strong></p><p>这里选择<code>Jupyter Notebook</code>，好处不言而喻，可上网查看，这里不赘述；<br>在windows10下安装Anaconda3并配置好环境，启动Anaconda Navigator，在其面板里下载配置TensorFlow、Keras、Jupyter Notebook、Vscode等库；</p><p><strong>2、入门猫狗数据集实验</strong></p><p>下载Kaggle狗猫数据集（mnist数据集略），按照 <a href="https://github.com/fchollet/deep-learning-with-python-notebooks/blob/master/5.2-using-convnets-with-small-datasets.ipynb" target="_blank" rel="noopener">参考教程</a>,完成狗猫数据集的分类实验；解释什么是overfit（过拟合），什么是数据增强？</p><p><strong>3、理解卷积神经网络CNN</strong></p><h1 id="一、环境配置"><a href="#一、环境配置" class="headerlink" title="一、环境配置"></a>一、环境配置</h1><h2 id="1-安装anaconda"><a href="#1-安装anaconda" class="headerlink" title="1.安装anaconda"></a>1.安装anaconda</h2><p>anaconda和python库是类似的，如果在同一计算机安装了两个环境，注意在IDE中选择对应的编译库。（pip安装都在anaconda目录下，而不在python安装目录下）</p><blockquote><p>清华下载源：<a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/</a><br>官方安装教程：<a href="http://docs.anaconda.com/anaconda/install/windows/" target="_blank" rel="noopener">http://docs.anaconda.com/anaconda/install/windows/</a></p></blockquote><p><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229103241118.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229103241118.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></p><blockquote><p>anaconda官方使用教程：<br><a href="http://docs.anaconda.com/anaconda/user-guide/getting-started/" target="_blank" rel="noopener">http://docs.anaconda.com/anaconda/user-guide/getting-started/</a><br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/2020022910352522.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/2020022910352522.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></p></blockquote><h2 id="2-jupyter-notebook配置"><a href="#2-jupyter-notebook配置" class="headerlink" title="2.jupyter notebook配置"></a>2.jupyter notebook配置</h2><h3 id="2-1修改运行时工作目录"><a href="#2-1修改运行时工作目录" class="headerlink" title="2.1修改运行时工作目录"></a>2.1修改运行时工作目录</h3><p>jupyter默认打开的工作空间是C盘，当然，第一件事是修改工作目录了。<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229103909283.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229103909283.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>wn10直接打开<strong>菜单</strong>目录，修改<strong>快捷键的属性</strong>即可：<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229104056427.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229104056427.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br><strong>修改目标位置为你的工作空间（我的在D盘）和起始位置（置空）：</strong><br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229104157674.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229104157674.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>再打开jupyter，目录显示应该在你的指定位置。</p><p>jupyter是做数据处理和图像显示比任何一款IDE都优势一些的工具：<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229111751398.png" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229111751398.png" alt="在这里插入图片描述"></a><br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229104648379.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229104648379.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></p><blockquote><p>常用指令参考：<a href="https://blog.csdn.net/5hongbing/article/details/78526196" target="_blank" rel="noopener">https://blog.csdn.net/5hongbing/article/details/78526196</a><br>navigator使用教程：<br><a href="http://docs.anaconda.com/anaconda/navigator/getting-started/" target="_blank" rel="noopener">http://docs.anaconda.com/anaconda/navigator/getting-started/</a></p></blockquote><h3 id="2-2添加jupyter-contrib-nbextensions插件"><a href="#2-2添加jupyter-contrib-nbextensions插件" class="headerlink" title="2.2添加jupyter_contrib_nbextensions插件"></a>2.2添加jupyter_contrib_nbextensions插件</h3><p>原生jupyter是没有：<code>自动补全代码功能+pep8+字体大小+代码行号+拼写检查+目录索引</code>这些功能的；当然有插件能帮我们完成.</p><ol><li><p>安装jupyter_contrib_nbextensions库：</p><pre><code> pip install jupyter_contrib_nbextensions -i https://pypi.douban.com/simple/</code></pre></li><li><p>配置到jupyter</p><pre><code> jupyter contrib nbextension install --user --skip-running-check</code></pre></li><li><p>重启jupyter notebook<br>安装完成后，重新启动jupyter notebook，“Nbextensions”出现在导航栏中，勾选目录<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229105226783.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229105226783.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>在原来的基础上勾选： “Table of Contents” 以及 “Hinterland”等，<br>（tips:autopep8需要安装<code>pip install autopep8</code>）<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229110001671.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229110001671.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>目录使用规则和Markdown相似，<code># 一级 ## 二级</code><br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229110524437.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229110524437.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>现在万事俱备了，接下来安装TensorFlow和keras。</p></li></ol><h2 id="3-配置TensorFlow、Keras"><a href="#3-配置TensorFlow、Keras" class="headerlink" title="3. 配置TensorFlow、Keras"></a>3. 配置TensorFlow、Keras</h2><p>有两种方法安装：</p><ol><li>启动Anaconda Navigator，在其面板里下载配置TensorFlow、Keras<a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229112037322.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229112037322.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229112047571.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229112047571.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>等待下载完成，测试：<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229112103712.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229112103712.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></li><li>在cmd中pip安装：（第一种方法虽好，但我还是热衷于命令行🥰）<br><code>Files-&gt;New-&gt;Teminal</code><br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229112206252.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229112206252.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>命令行安装：<pre><code> pip install tensorflow
 pip install keras</code></pre>exp：<a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/202002291123014.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_1,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/202002291123014.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_1,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>同理，在cmd中安装效果一样，肯定人和我的喜好一样，haha~</li></ol><h1 id="二、入门实例-猫狗数据集"><a href="#二、入门实例-猫狗数据集" class="headerlink" title="二、入门实例-猫狗数据集"></a>二、入门实例-猫狗数据集</h1><h2 id="1-制作数据集"><a href="#1-制作数据集" class="headerlink" title="1.制作数据集"></a>1.制作数据集</h2><blockquote><p>在数据分析处理这一块，原数据模型是最值价的了，常用的是<a href="https://www.kaggle.com/" target="_blank" rel="noopener">kaggle</a>网站的数据集</p><ol><li><a href="https://www.cnblogs.com/inchbyinch/p/11965203.html" target="_blank" rel="noopener">从Kaggle下载猫狗数据集</a><br>或者：链接：<a href="https://pan.baidu.com/s/13hw4LK8ihR6-6-8mpjLKDA" target="_blank" rel="noopener">https://pan.baidu.com/s/13hw4LK8ihR6-6-8mpjLKDA</a> 密码：<strong>dmp4</strong></li><li>根据<a href="https://github.com/fchollet/deep-learning-with-python-notebooks/blob/master/5.2-using-convnets-with-small-datasets.ipynb" target="_blank" rel="noopener">教程</a>完成对猫狗数据集的处理：<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229113250110.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229113250110.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></li></ol></blockquote><p>（1）运行程序：根据命名对图片分类：<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229113424737.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229113424737.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>详细文件内容：<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229113515731.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229113515731.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>图片分类：</p><pre><code class="python">import os, shutil
# The path to the directory where the original
# dataset was uncompressed
original_dataset_dir = &#39;D:/python_project/kaggle_Dog&amp;Cat/train&#39;

# The directory where we will
# store our smaller dataset
base_dir = &#39;D:/python_project/kaggle_Dog&amp;Cat/find_cats_and_dogs&#39;
os.mkdir(base_dir)

# Directories for our training,
# validation and test splits
train_dir = os.path.join(base_dir, &#39;train&#39;)
os.mkdir(train_dir)
validation_dir = os.path.join(base_dir, &#39;validation&#39;)
os.mkdir(validation_dir)
test_dir = os.path.join(base_dir, &#39;test&#39;)
os.mkdir(test_dir)

# Directory with our training cat pictures
train_cats_dir = os.path.join(train_dir, &#39;cats&#39;)
os.mkdir(train_cats_dir)

# Directory with our training dog pictures
train_dogs_dir = os.path.join(train_dir, &#39;dogs&#39;)
os.mkdir(train_dogs_dir)

# Directory with our validation cat pictures
validation_cats_dir = os.path.join(validation_dir, &#39;cats&#39;)
os.mkdir(validation_cats_dir)

# Directory with our validation dog pictures
validation_dogs_dir = os.path.join(validation_dir, &#39;dogs&#39;)
os.mkdir(validation_dogs_dir)

# Directory with our validation cat pictures
test_cats_dir = os.path.join(test_dir, &#39;cats&#39;)
os.mkdir(test_cats_dir)

# Directory with our validation dog pictures
test_dogs_dir = os.path.join(test_dir, &#39;dogs&#39;)
os.mkdir(test_dogs_dir)

# Copy first 1000 cat images to train_cats_dir
fnames = [&#39;cat.{}.jpg&#39;.format(i) for i in range(1000)]
for fname in fnames:
    src = os.path.join(original_dataset_dir, fname)
    dst = os.path.join(train_cats_dir, fname)
    shutil.copyfile(src, dst)

# Copy next 500 cat images to validation_cats_dir
fnames = [&#39;cat.{}.jpg&#39;.format(i) for i in range(1000, 1500)]
for fname in fnames:
    src = os.path.join(original_dataset_dir, fname)
    dst = os.path.join(validation_cats_dir, fname)
    shutil.copyfile(src, dst)

# Copy next 500 cat images to test_cats_dir
fnames = [&#39;cat.{}.jpg&#39;.format(i) for i in range(1500, 2000)]
for fname in fnames:
    src = os.path.join(original_dataset_dir, fname)
    dst = os.path.join(test_cats_dir, fname)
    shutil.copyfile(src, dst)

# Copy first 1000 dog images to train_dogs_dir
fnames = [&#39;dog.{}.jpg&#39;.format(i) for i in range(1000)]
for fname in fnames:
    src = os.path.join(original_dataset_dir, fname)
    dst = os.path.join(train_dogs_dir, fname)
    shutil.copyfile(src, dst)

# Copy next 500 dog images to validation_dogs_dir
fnames = [&#39;dog.{}.jpg&#39;.format(i) for i in range(1000, 1500)]
for fname in fnames:
    src = os.path.join(original_dataset_dir, fname)
    dst = os.path.join(validation_dogs_dir, fname)
    shutil.copyfile(src, dst)

# Copy next 500 dog images to test_dogs_dir
fnames = [&#39;dog.{}.jpg&#39;.format(i) for i in range(1500, 2000)]
for fname in fnames:
    src = os.path.join(original_dataset_dir, fname)
    dst = os.path.join(test_dogs_dir, fname)
    shutil.copyfile(src, dst)</code></pre><p>（2）统计图片数量：</p><pre><code class="python">print(&#39;total training cat images:&#39;, len(os.listdir(train_cats_dir)))
print(&#39;total training dog images:&#39;, len(os.listdir(train_dogs_dir)))
print(&#39;total validation cat images:&#39;, len(os.listdir(validation_cats_dir)))
print(&#39;total validation dog images:&#39;, len(os.listdir(validation_dogs_dir)))
print(&#39;total test cat images:&#39;, len(os.listdir(test_cats_dir)))
print(&#39;total test dog images:&#39;, len(os.listdir(test_dogs_dir)))</code></pre><p><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/2020022911355998.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/2020022911355998.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>猫狗训练图片各1000张，验证图片各500张，测试图片各500张。</p><h2 id="2-卷积神经网络CNN"><a href="#2-卷积神经网络CNN" class="headerlink" title="2.卷积神经网络CNN"></a>2.卷积神经网络CNN</h2><p>快速开发基准模型：面对一个任务，通常需要快速验证想法，并不断迭代。因此开发基准模型通常需要快速，模型能跑起来，效果比随机猜测好一些就行，不用太在意细节。至于正则化、图像增强、参数选取等操作，后续会根据需要来进行。<a href="参考：[CNN基础一：从头开始训练CNN进行图像分类（猫狗大战为例）](https://www.cnblogs.com/inchbyinch/p/11971358.html)">^3</a></p><h3 id="2-1-网络模型搭建"><a href="#2-1-网络模型搭建" class="headerlink" title="2.1 网络模型搭建"></a>2.1 网络模型搭建</h3><p><code>model.summary()</code>输出模型各层的参数状况</p><pre><code class="python">from keras import layers
from keras import models

model = models.Sequential()
model.add(layers.Conv2D(32, (3, 3), activation=&#39;relu&#39;,
                        input_shape=(150, 150, 3)))
model.add(layers.MaxPooling2D((2, 2)))
model.add(layers.Conv2D(64, (3, 3), activation=&#39;relu&#39;))
model.add(layers.MaxPooling2D((2, 2)))
model.add(layers.Conv2D(128, (3, 3), activation=&#39;relu&#39;))
model.add(layers.MaxPooling2D((2, 2)))
model.add(layers.Conv2D(128, (3, 3), activation=&#39;relu&#39;))
model.add(layers.MaxPooling2D((2, 2)))
model.add(layers.Flatten())
model.add(layers.Dense(512, activation=&#39;relu&#39;))
model.add(layers.Dense(1, activation=&#39;sigmoid&#39;))
model.summary()</code></pre><p><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/2020022911400446.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/2020022911400446.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></p><h3 id="2-2-图像生成器读取文件中数据"><a href="#2-2-图像生成器读取文件中数据" class="headerlink" title="2.2 图像生成器读取文件中数据"></a>2.2 图像生成器读取文件中数据</h3><ul><li><code>model.compile()</code>优化器(loss：计算损失，这里用的是交叉熵损失,metrics: 列表，包含评估模型在训练和测试时的性能的指标)</li><li>所有图片（2000张）重设尺寸大小为150x150大小</li><li>ImageDataGenerator就像一个把文件中图像转换成所需格式的转接头，通常先定制一个转接头train_datagen，它可以根据需要对图像进行各种变换，然后再把它怼到文件中（flow方法是怼到array中），约定好出来数据的格式（比如图像的大小、每次出来多少样本、样本标签的格式等等）。这里出来的train_generator是个（X,y）元组，X的shape为(20,150,150,3)，y的shape为(20,)<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229114227324.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229114227324.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><h3 id="2-3-开始训练"><a href="#2-3-开始训练" class="headerlink" title="2.3 开始训练"></a>2.3 开始训练</h3><code>generator()</code><br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229114232212.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229114232212.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>loss 损失函数值，与你定义的损失函数值相关<br>acc 准确率<br>mean_absolute_error 平均绝对误差<br>前面带val_表示你的模型在验证集上进行验证时输出的这三个值，验证在每个epoch后进行<br>一个选拔的故事（acc,loss,val_acc,val_loss的区别)：<br><a href="http://www.pianshen.com/article/5415291383/" target="_blank" rel="noopener">http://www.pianshen.com/article/5415291383/</a><br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229115403967.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229115403967.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><h3 id="2-4-保存模型"><a href="#2-4-保存模型" class="headerlink" title="2.4 保存模型"></a>2.4 保存模型</h3><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229115414583.png" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229115414583.png" alt="在这里插入图片描述"></a><h3 id="2-5-结果可视化"><a href="#2-5-结果可视化" class="headerlink" title="2.5 结果可视化"></a>2.5 结果可视化</h3>训练结果如下图所示，很明显模型上来就过拟合了，主要原因是数据不够，或者说相对于数据量，模型过复杂（训练损失在第30个epoch就降为0了）。<pre><code class="python">import matplotlib.pyplot as plt
</code></pre></li></ul><p>acc = history.history[‘acc’]<br>val_acc = history.history[‘val_acc’]<br>loss = history.history[‘loss’]<br>val_loss = history.history[‘val_loss’]</p><p>epochs = range(len(acc))</p><p>plt.plot(epochs, acc, ‘bo’, label=’Training acc’)<br>plt.plot(epochs, val_acc, ‘b’, label=’Validation acc’)<br>plt.title(‘Training and validation accuracy’)<br>plt.legend()</p><p>plt.figure()</p><p>plt.plot(epochs, loss, ‘bo’, label=’Training loss’)<br>plt.plot(epochs, val_loss, ‘b’, label=’Validation loss’)<br>plt.title(‘Training and validation loss’)<br>plt.legend()</p><p>plt.show()</p><pre><code>
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200229115448680.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70)
## 3.根据基准模型进行调整
为了解决过拟合问题，可以减小模型复杂度，也可以用一系列手段去对冲，比如增加数据（图像增强、人工合成或者多搜集真实数据）、L1/L2正则化、dropout正则化等。这里主要介绍CV中最常用的图像增强。
### 3.1 图像增强方法
在Keras中，可以利用图像生成器很方便地定义一些常见的图像变换。将变换后的图像送入训练之前，可以按变换方法逐个看看变换的效果。代码如下：
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200229115620801.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200229125610231.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70)
```python
datagen = ImageDataGenerator(
      rotation_range=40,
      width_shift_range=0.2,
      height_shift_range=0.2,
      shear_range=0.2,
      zoom_range=0.2,
      horizontal_flip=True,
      fill_mode=&#39;nearest&#39;)
# This is module with image preprocessing utilities
from keras.preprocessing import image
fnames = [os.path.join(train_cats_dir, fname) for fname in os.listdir(train_cats_dir)]
# We pick one image to &quot;augment&quot;
img_path = fnames[3]
# Read the image and resize it
img = image.load_img(img_path, target_size=(150, 150))
# Convert it to a Numpy array with shape (150, 150, 3)
x = image.img_to_array(img)
# Reshape it to (1, 150, 150, 3)
x = x.reshape((1,) + x.shape)
# The .flow() command below generates batches of randomly transformed images.
# It will loop indefinitely, so we need to `break` the loop at some point!
i = 0
for batch in datagen.flow(x, batch_size=1):
    plt.figure(i)
    imgplot = plt.imshow(image.array_to_img(batch[0]))
    i += 1
    if i % 4 == 0:
        break
plt.show()</code></pre><h3 id="3-2-模型调整"><a href="#3-2-模型调整" class="headerlink" title="3.2 模型调整"></a>3.2 模型调整</h3><ul><li>将这几种选定的图像增强方法添加进训练集的生成器中（train_datagen）；</li><li>在模型结构中加入一层Dropout（在Flatten层后加上 Dropout(0.5)）。<br>调整并重新训练改为100个epoch。重新训练后的结果如图所示。可以看出，准确率由基准的67%提高到82%，进一步调整模型还可以提升到86%左右。但是进一步就再难以继续提升了，因为数据太少，且模型比较粗糙，下一节我们会采取其他更有效的措施。<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229125751574.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229125751574.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><h2 id="4-卷积神经网络的可视化"><a href="#4-卷积神经网络的可视化" class="headerlink" title="4. 卷积神经网络的可视化"></a>4. 卷积神经网络的可视化</h2><blockquote><p><a href="https://github.com/fchollet/deep-learning-with-python-notebooks/blob/master/5.4-visualizing-what-convnets-learn.ipynb" target="_blank" rel="noopener">教程</a></p></blockquote></li></ul><ol><li><p>导入100次训练模型，查看模型参数<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229130033749.png" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229130033749.png" alt="在这里插入图片描述"></a><br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229130100164.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229130100164.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></p><pre><code class="python"> from keras.models import load_model
 model = load_model(&#39;cats_and_dogs_small_1.h5&#39;)
 model.summary()  # As a reminder.</code></pre></li><li><p>模型预处理<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/2020022913012816.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/2020022913012816.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></p><pre><code class="python"> img_path = &#39;D:/python_project/kaggle_Dog&amp;Cat/find_cats_and_dogs/test/cats/cat.1502.jpg&#39;

 # We preprocess the image into a 4D tensor
 from keras.preprocessing import image
 import numpy as np

 img = image.load_img(img_path, target_size=(150, 150))
 img_tensor = image.img_to_array(img)
 img_tensor = np.expand_dims(img_tensor, axis=0)
 # Remember that the model was trained on inputs
 # that were preprocessed in the following way:
 img_tensor /= 255.

 # Its shape is (1, 150, 150, 3)
 print(img_tensor.shape)</code></pre></li><li><p>输入一张不属于网络的猫的图像<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229130155456.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229130155456.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></p><pre><code class="python"> import matplotlib.pyplot as plt

 plt.imshow(img_tensor[0])
 plt.show()</code></pre></li><li><p>为了提取想要查看的特征图，我们需要创建一个Keras模型，以图像批量作为输入，并输出所有卷积层和池化层的激活。为此，我们需要使用Keras的Model类。模型实例化需要两个参数：一个输入张量（或输入张量的列表）和一个输出张量（或输出张量的列表）。</p><ul><li><p>layer_outputs:提取前8层的输出</p></li><li><p>activation_model:创建一个模型，给定模型的输入，可以返回这些输出</p></li><li><p>activations :输入一张图像，这个模型将返回8个Numpy数组组成的列表，每个层激活对应一个Numpy数组<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229130208707.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229130208707.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>它是大小为148*148的特征图，有32个通道。我们来绘制原始模型第3个通道:<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229130220993.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229130220993.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>再看看第30个通道：<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229130226795.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229130226795.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>我们可以看到，似乎不同通道对于图像检测有不同侧重，比如第3个通道更侧重于边缘检测，第30个通道更侧于”绿色圆点“检测。</p><p>下面我们来绘制网络中所有激活的完整可视化图。我们需要在8个特征图里的每一个都提取并绘制一个通道，然后将结果叠加在一个大的图像张量中，按通道并排。<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229130234611.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229130234611.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229130243997.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229130243997.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></p><blockquote><p>参考：<a href="https://blog.csdn.net/Einstellung/article/details/82832872" target="_blank" rel="noopener">可视化中间激活</a><a href="参考：[可视化中间激活](https://blog.csdn.net/Einstellung/article/details/82832872)">^2</a></p></blockquote></li></ul></li></ol><h1 id="三、CNN模型"><a href="#三、CNN模型" class="headerlink" title="三、CNN模型"></a>三、CNN模型</h1><h2 id="3-1-神经网络结构"><a href="#3-1-神经网络结构" class="headerlink" title="3.1 神经网络结构"></a>3.1 神经网络结构</h2><ol><li>单层神经网络<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229130946397.png" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229130946397.png" alt="在这里插入图片描述"></a><br>表达式：（也称为<strong>Logistic回归模型</strong>）<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229131001126.png" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229131001126.png" alt="在这里插入图片描述"></a></li><li>多层神经网络结构<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229131057655.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229131057655.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a><br>表达式：（如此一层一层的加上去，最终就形成了<strong>深度神经网络</strong>）<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/20200229131109737.png" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/20200229131109737.png" alt="在这里插入图片描述"></a><h2 id="3-2-卷积神经网络CNN"><a href="#3-2-卷积神经网络CNN" class="headerlink" title="3.2 卷积神经网络CNN"></a>3.2 卷积神经网络CNN</h2><blockquote><p>参考：<a href="https://blog.csdn.net/love__live1/article/details/79481052" target="_blank" rel="noopener">cnn算法</a></p></blockquote></li></ol><p><strong>卷积神经网络CNN的结构一般包含这几个层：</strong><a href="参考：[cnn算法](https://blog.csdn.net/love__live1/article/details/79481052)">^1</a></p><ul><li>输入层：用于数据的输入</li><li>卷积层：使用卷积核进行特征提取和特征映射</li><li>激励层：由于卷积也是一种线性运算，因此需要增加非线性映射</li><li>池化层：进行下采样，对特征图稀疏处理，减少数据运算量。</li><li>全连接层：通常在CNN的尾部进行重新拟合，减少特征信息的损失<br><a data-fancybox="gallery" data-caption="在这里插入图片描述" href="https://img-blog.csdnimg.cn/2020022913075070.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_1,color_FFFFFF,t_70" target="_blank" rel="noopener"><img data-action="zoom" src="https://img-blog.csdnimg.cn/2020022913075070.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1bmd1ZGFmYQ==,size_1,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></li></ul><p><strong>CNN的三个特点：</strong></p><ul><li>局部连接：这个是最容易想到的，每个神经元不再和上一层的所有神经元相连，而只和一小部分神经元相连。这样就减少了很多参数</li><li>权值共享：一组连接可以共享同一个权重，而不是每个连接有一个不同的权重，这样又减少了很多参数。</li><li>下采样：可以使用Pooling来减少每层的样本数，进一步减少参数数量，同时还可以提升模型的鲁棒性。</li></ul></div><div class="single-reward"><div class="reward-open">赏<div class="reward-main"><ul class="reward-row"><li class="alipay-code"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/custom/donate/AliPay.jpg"></li><li class="wechat-code"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/custom/donate/WeChatPay.png"></li></ul></div></div></div><div style="text-align:center;width:100%" class="social-share share-mobile" data-disabled="diandian, tencent"></div><footer class="post-footer"><div class="post-lincenses" style="color:#f96">欢迎转载，转载时请注明来源哦！ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" style="color:#f96" target="_blank" rel="nofollow"><i class="fa fa-creative-commons" aria-hidden="true"></i>ncsa4.0</a></div><div class="post-tags" style="color:#a39391"><span><i class="fa fa-tags"></i> <a href="/tags/tensorflow/" style="color:#716e77">tensorflow<em>·</em></a> <a href="/tags/keras/" style="color:#716e77">keras<em>·</em></a> <a href="/tags/CNN/" style="color:#716e77">CNN<em>·</em></a> </span><span><i class="iconfont icon-file"></i> <a href="/categories/%E6%8A%80%E6%9C%AF/" style="color:#716e77">技术</a></span></div><div class="post-share"><div class="social-share sharehidden share-component"></div><i class="iconfont show-share icon-forward"></i></div></footer><div class="tag-cloud"><div class="tag-cloud-title"></div><div class="tag-cloud-tags"><a href="/tags/CNN/" style="font-size:10px;color:#f06966">CNN</a> <a href="/tags/Ps/" style="font-size:10px;color:#f06966">Ps</a> <a href="/tags/SEO/" style="font-size:10px;color:#f06966">SEO</a> <a href="/tags/SSL/" style="font-size:10px;color:#f06966">SSL</a> <a href="/tags/cdn/" style="font-size:10px;color:#f06966">cdn</a> <a href="/tags/diy/" style="font-size:10px;color:#f06966">diy</a> <a href="/tags/fancybox/" style="font-size:12.5px;color:#c27d87">fancybox</a> <a href="/tags/hexo/" style="font-size:10px;color:#f06966">hexo</a> <a href="/tags/https/" style="font-size:10px;color:#f06966">https</a> <a href="/tags/js%E6%8F%92%E4%BB%B6/" style="font-size:10px;color:#f06966">js插件</a> <a href="/tags/keras/" style="font-size:10px;color:#f06966">keras</a> <a href="/tags/nginx/" style="font-size:10px;color:#f06966">nginx</a> <a href="/tags/nick/" style="font-size:10px;color:#f06966">nick</a> <a href="/tags/pyecharts/" style="font-size:10px;color:#f06966">pyecharts</a> <a href="/tags/tensorflow/" style="font-size:10px;color:#f06966">tensorflow</a> <a href="/tags/valine/" style="font-size:17.5px;color:#67a6c8">valine</a> <a href="/tags/web/" style="font-size:10px;color:#f06966">web</a> <a href="/tags/%E4%BB%8A%E6%97%A5%E8%AF%97%E8%AF%8D/" style="font-size:10px;color:#f06966">今日诗词</a> <a href="/tags/%E5%85%8D%E8%B4%B9/" style="font-size:10px;color:#f06966">免费</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size:20px;color:#39bae8">前端</a> <a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size:10px;color:#f06966">加密</a> <a href="/tags/%E5%8A%A8%E7%94%BB/" style="font-size:15px;color:#9592a7">动画</a> <a href="/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" style="font-size:10px;color:#f06966">博客搭建</a> <a href="/tags/%E5%9B%BE%E9%9B%86/" style="font-size:15px;color:#9592a7">图集</a> <a href="/tags/%E5%A4%96%E9%93%BE/" style="font-size:10px;color:#f06966">外链</a> <a href="/tags/%E5%A4%B4%E5%83%8F/" style="font-size:12.5px;color:#c27d87">头像</a> <a href="/tags/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/" style="font-size:12.5px;color:#c27d87">微信公众号</a> <a href="/tags/%E6%82%A6%E8%AF%BB/" style="font-size:10px;color:#f06966">悦读</a> <a href="/tags/%E6%8A%80%E6%9C%AF/" style="font-size:10px;color:#f06966">技术</a> <a href="/tags/%E6%96%87%E7%AB%A0/" style="font-size:12.5px;color:#c27d87">文章</a> <a href="/tags/%E6%A0%87%E7%AD%BE%E4%BA%91/" style="font-size:12.5px;color:#c27d87">标签云</a> <a href="/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E8%A8%80/" style="font-size:10px;color:#f06966">每日一言</a> <a href="/tags/%E7%94%9F%E6%B4%BB/" style="font-size:10px;color:#f06966">生活</a> <a href="/tags/%E7%9F%A5%E7%BD%91%E8%AE%BA%E6%96%87/" style="font-size:10px;color:#f06966">知网论文</a> <a href="/tags/%E7%A7%81%E4%BA%BA%E5%9B%BE%E5%BA%8A/" style="font-size:10px;color:#f06966">私人图床</a> <a href="/tags/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/" style="font-size:10px;color:#f06966">经验分享</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%9B%9E%E5%A4%8D%E6%9C%BA%E5%99%A8%E4%BA%BA/" style="font-size:10px;color:#f06966">自动回复机器人</a> <a href="/tags/%E8%AF%B4%E8%AF%B4%E3%80%81%E5%BF%83%E6%83%85/" style="font-size:10px;color:#f06966">说说、心情</a> <a href="/tags/%E9%82%AE%E4%BB%B6/" style="font-size:12.5px;color:#c27d87">邮件</a> <a href="/tags/%E9%82%AE%E7%AE%B1/" style="font-size:10px;color:#f06966">邮箱</a> <a href="/tags/%E9%98%BF%E9%87%8C%E4%BA%91/" style="font-size:10px;color:#f06966">阿里云</a> <a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size:10px;color:#f06966">随笔</a></div></div></article><div class="toc" style="background:0 0"></div><section class="post-squares nextprev"><div class="post-nepre half previous"><a href="/post/32c1.html" rel="prev"><div class="background"><img class="lazyload" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.pixabay.com/photo/2018/05/28/09/32/technology-3435575__340.jpg" style="width:100%;height:100%;object-fit:cover;pointer-events:none" onerror="imgError(this,3)" src="https://cdn.pixabay.com/photo/2018/05/28/09/32/technology-3435575__340.jpg"></div><span class="label">Previous Post</span><div class="info"><h3>Hexo自动部署到阿里云(Ubantu16.04)【超详细踩坑记录】</h3><hr></div></a></div><div class="post-nepre half next"><a href="/post/cb8f.html" rel="next"><div class="background"><img class="lazyload" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://img-blog.csdnimg.cn/20200225161813413.png" style="width:100%;height:100%;object-fit:cover;pointer-events:none" onerror="imgError(this,3)" src="https://img-blog.csdnimg.cn/20200225161813413.png"></div><span class="label">Next Post</span><div class="info"><h3>Valine-自定义邮件回复提示</h3><hr></div></a></div></section><section class="comment"><div id="vcomments"></div><script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><script src="../js/Valine.min.js"></script><style>.v .vwrap{padding:0 0 44px}.v .veditor{min-height:10rem;background-image:url(https://cdn.jsdelivr.net/gh/cungudafa/img/images/girls2.png);background-size:contain;background-repeat:no-repeat;background-position:right;background-color:rgba(255,255,255,0);resize:none}.v .vwrap .vedit{padding-top:20px}.v .vwrap .vheader{width:80%;bottom:0;position:absolute;background:#fff7f7f7}.v .vinput{padding:10px 15px;text-align:center}.v .vwrap .vheader .vinput{border-bottom:0}.v .vwrap .vedit .vctrl{margin-top:-44px;right:0;position:absolute;margin-right:-3px}.v .vwrap .vcontrol{position:absolute;right:0;bottom:0;width:20%;padding-top:0}.v .vwrap .vcontrol .col.col-20,.v .vwrap .vedit .vctrl span.vpreview-btn{display:none}.v .vwrap .vcontrol .col.col-80{width:100%}.v .vbtn.vsubmit{border-radius:0;padding:0;color:#fff;line-height:44px;width:100%;border:none;background:#f99}.v .vlist .vcard .vhead .vsys{background:#fff7f7f7}.v .vlist .vcard .vh .vmeta .vat{font-size:12px;display:block;margin-left:15px;float:right;color:#fff;background-color:#f99;line-height:20px;padding:0 6px;border-radius:3px}@media screen and (max-width:520px){.v .vwrap .vheader .vinput{width:33.33%;padding:10px 5px}}</style><script>new Valine({
        el: '#vcomments',
        lang: 'zh-cn',
        admin_email: 'cungudafa@163.com',//博主邮箱
        appId: "cBzr9TtJ0xY0s6f3H8bpmB3M-gzGzoHsz",
        appKey: "3opMyv2Vyx3mHa0IWitRGSoi",
        path: window.location.pathname,
        comment_count: true,
        notify: false, // 邮件提醒!使用第三方就不要添加这个!!
        verify: true, //验证码
        avatar: 'monsterid',//小怪物头像
        placeholder: "你是我一生只会遇见一次的惊喜 ...",
        emoticon_url: 'https://cloud.panjunwen.com/alu',//自定义表情
        emoticon_list: ["狂汗.png","不说话.png","汗.png","坐等.png","献花.png","不高兴.png","中刀.png","害羞.png","皱眉.png","小眼睛.png","暗地观察.png"]
    });
    
    //   自定义邮箱审核规则
    document.body.addEventListener('click', function(e) {
        if (e.target.classList.contains('vsubmit')) {
            const email = document.querySelector('input[type=email]');
            const nick = document.querySelector('input[name=nick]');
            const link = document.querySelector('input[name=link]');
            const reg = /^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;//邮箱
            const reg2=/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/;  //正则表达式，url
            if (!email.value || !nick.value || !reg.test(email.value)) {
                const str = `<div class="valert text-center"><div class="vtext">请填写正确的昵称和邮箱！</div></div>`;
                if(!link.value ||!reg2.test(link.value)){//链接不是必填,填写则校验
                    const str = `<div class="valert text-center"><div class="vtext">请检查昵称、邮箱、网址是否填写正确！</div></div>`;
                }
                const vmark = document.querySelector('.vmark');
                vmark.innerHTML = str;
                vmark.style.display = 'block';

                setTimeout(function() {
                    vmark.style.display = 'none';
                    vmark.innerHTML = '';
                }, 2500);
            }  
        }
    });
    // 点击回复直接评论,官方版本点击回复时都是跳回到页面上方的评论框进行回复，评论框是固定不动的
    // 参考https://immmmm.com/valine-diy
    $(document).ready(function(){
        //$('.vemoji-btn').text('😀');
        $("#vcomments").on('click', 'span.vat',function(){
            $(this).parent('div.vmeta').next("div.vcontent").after($("div.vwrap"));
            $('textarea#veditor').focus();
        });
        if(e.target.classList.contains('vsys')) {
            const chometype = document.getElementById(".vsys");
            console.log(chometype);
        };
    })</script><script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script><script type="text/javascript">jinrishici.load(function(t){var i=t.data.content+"\n「"+t.data.origin.title+"」"+t.data.origin.dynasty+" · "+t.data.origin.author;document.getElementById("veditor").setAttribute("placeholder",i)})</script></section><section class="author-profile"><div class="info" itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="https://cungudafa.gitee.io" class="profile gravatar"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/custom/cungudafa.jpg" itemprop="image" alt="cungudafa" height="70" width="70"></a><div class="meta"><span class="title">Author</span><h3 itemprop="name"><a href="https://cungudafa.gitee.io" itemprop="url" rel="author">cungudafa</a></h3></div></div><hr><p><i class="iconfont icon-write"></i>姑，一个学习记录者</p></section></main></div></div><script>$(document).ready(function () {
    var now = new Date();
    // 获取到当前小时
    var getHours = now.getHours();
    if(getHours <=7 && getHours<=23){//getHours >=7 && getHours<=23
        valine_init();
    }else{
        const str = `<div>凌晨0am到6am，Valine休眠中哦，想联系姑，可以在Daovoice留言，或者去首页找找联系方式哦！</div>`;
        const vcomments = document.querySelector('.vcomments');
        vcomments.innerHTML = str;
        vcomments.style.display = 'block';

        setTimeout(function() {
            vcomments.style.display = 'none';
            vcomments.innerHTML = '';
        }, 2500);
    }
  });</script></div><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="请输入关键词..."> <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>!function(T){var O={TRANSLATION:{POSTS:"文章",CATEGORIES:"分类",TAGS:"标签"},ROOT_URL:"/",CONTENT_URL:"/content.json"};T.INSIGHT_CONFIG=O}(window)</script><footer id="colophon" class="site-footer" role="contentinfo"><div class="site-info"><div class="footertext"><div class="img-preload"><img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/wordpress-rotating-ball-o.svg"> <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/disqus-preloader.svg"></div><div id="footer-info" class="inner"><p style="font-family:Ubuntu,sans-serif"><span style="color:#666">渝ICP备19001829号</span></p></div></div><div class="footer-device"><p style="font-family:Ubuntu,sans-serif"><span style="color:#b9b9b9">Blog cungudafa <i class="iconfont icon-sakura rotating" style="color:pink;display:inline-block"></i> Copyright &copy; 2020 by 姑 All Rights Reserved.</span></p></div><span style="color:#f99;padding-left:20px"><i class="fa fa-clock-o" aria-hidden="true"></i> <span id="time" align="center">载入时间中...</span><script>function createtime(){var n=new Date("2020-02-11 17:20:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("time").innerHTML="小破站在各种灾难中苟活了 "+dnum+" 天 "+hnum+" 小时 "+mnum+" 分 "+snum+" 秒"}var now=new Date;setInterval("createtime()",250)</script><span style="color:#f99;padding-left:20px"><i class="fa fa-line-chart" aria-hidden="true"></i> 博客全站共<span class="post-count">31.9k</span>字</span><span style="color:#f99;padding-left:20px"><i class="fa fa-fire" aria-hidden="true"></i><span id="busuanzi_container_site_pv">总热度 <span id="busuanzi_value_site_pv"></span>℃</span></span></span></div><div class="skin-menu no-select" id="mainskin" style="position:fixed"><div class="theme-controls row-container"><ul class="menu-list"><li id="white-bg"><i class="fa fa-television" aria-hidden="true"></i></li><li id="sakura-bg"><i class="iconfont icon-sakura"></i></li><li id="gribs-bg"><i class="fa fa-slack" aria-hidden="true"></i></li><li id="KAdots-bg"><i class="iconfont icon-dots"></i></li><li id="totem-bg"><i class="fa fa-optin-monster" aria-hidden="true"></i></li><li id="pixiv-bg"><i class="iconfont icon-pixiv"></i></li><li id="bing-bg"><i class="iconfont icon-bing"></i></li><li id="dark-bg"><i class="fa fa-moon-o" aria-hidden="true"></i></li></ul></div><div class="font-family-controls row-container"><button type="button" class="control-btn-serif selected" data-mode="serif" onclick="mashiro_global.font_control.change_font()">Serif</button> <button type="button" class="control-btn-sans-serif" data-mode="sans-serif" onclick="mashiro_global.font_control.change_font()">Sans Serif</button></div></div><canvas id="night-mode-cover"></canvas><div class="changeSkin-gear no-select"><div class="keys" id="setbtn"><span id="open-skinMenu">切换壁纸 | SCHEME TOOL &nbsp;<i class="iconfont icon-gear inline-block rotating"></i></span></div></div></footer><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/js/lib.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/js/InsightSearch.js"></script><script src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/js/botui.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/js/sakura-app.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/js/jquery.fancybox.min.js"></script><script>$('[data-fancybox="images"]').fancybox({thumbs:{autoStart:!0}}),$("[data-fancybox]").fancybox({protect:!0,youtube:{controls:0,showinfo:0},vimeo:{color:"f00"}})</script><script src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/live2d-widget/autoload.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"><script src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/js/hititle.js"></script><script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/shehuizhuyi.js"></script><canvas class="fireworks" style="position:fixed;left:0;top:0;z-index:1;pointer-events:none"></canvas><script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script><script src="https://cdn.jsdelivr.net/gh/Yafine/cdn@2.5/source/js/fireworks.js"></script><script src="https://cdn.jsdelivr.net/gh/Yafine/cdn@2.5/source/js/cursor.js"></script><script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/love.js"></script><script src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/js/piao.js" type="text/javascript"></script><script src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script><script>!function(e,t,o,a,c,i,n){e.DaoVoiceObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,i=t.createElement(o),n=t.getElementsByTagName(o)[0],i.async=1,i.src=a,i.charset="utf-8",n.parentNode.insertBefore(i,n)}(window,document,"script",("https:"==document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/f6b2a0b1.js","daovoice"),daovoice("init",{app_id:"f6b2a0b1"}),daovoice("update")</script><script type="text/javascript">WIDGET={FID:"yqRrzxwtvs"}</script><script type="text/javascript" src="https://apip.weatherdt.com/float/static/js/r.js?v=1111"></script><script type="text/javascript">if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent))var Poi={pjax:"1",movies:{url:"https://cdn.jsdelivr.net/gh/honjun/hojun@1.2",name:"Unbroken.mp4",live:"close"},windowheight:"fixed",codelamp:"close",ajaxurl:"",order:"asc",formpostion:"bottom"};else var Poi={pjax:"1",movies:{url:"https://cdn.jsdelivr.net/gh/honjun/hojun@1.2",name:"Unbroken.mp4",live:"open"},windowheight:"auto",codelamp:"close",ajaxurl:"",order:"asc",formpostion:"bottom"}</script><script>$(document).ready(function(){if($(".toc").length>0&&document.body.clientWidth>1200){$(".pattern-center").length>0?tocbot.init({tocSelector:".toc",contentSelector:".entry-content",scrollSmooth:!0,headingSelector:"h1, h2, h3, h4, h5",headingsOffset:-400,scrollSmoothOffset:-85}):tocbot.init({tocSelector:".toc",contentSelector:".entry-content",scrollSmooth:!0,headingSelector:"h1, h2, h3, h4, h5",headingsOffset:-85,scrollSmoothOffset:-85});var t=$(".toc").offset().top-95;window.onscroll=function(){var o=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;o>=t?$(".toc").addClass("toc-fixed"):$(".toc").removeClass("toc-fixed")}}})</script><div class="openNav no-select" style="height:50px"><div class="iconflat no-select" style="width:50px;height:50px"><div class="icon"></div></div><div class="site-branding search-form-submit"><i class="iconfont js-toggle-search iconsearch icon-search"></i></div></div></section><div id="mo-nav"><div class="m-avatar"><img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/custom/cungudafa.jpg"></div><p style="text-align:center;color:#333;font-weight:900;font-family:Ubuntu,sans-serif;letter-spacing:1.5px">cungudafa姑</p><p style="text-align:center;word-spacing:20px"><a href="http://github.com/cungudafa" class="fa fa-github" target="_blank" style="color:#333;margin-left:20px"></a> <a href="http://weibo.com/3829198906/info" class="fa fa-weibo" target="_blank" style="color:#dd4b39;margin-left:20px"></a> <a href="https://blog.csdn.net/cungudafa" class="fa fa-star" target="_blank" style="color:#f90;margin-left:20px"></a></p><ul id="menu-new-1" class="menu"><li><a href="/"><span class="faa-parent animated-hover"><i class="fa fa-fort-awesome faa-shake" aria-hidden="true"></i> 首页</span></a></li><li><a href="/archives"><span class="faa-parent animated-hover"><i class="fa fa-archive faa-shake" aria-hidden="true"></i> 归档</span></a><ul class="sub-menu"><li><a href="/tags"><i class="fa fa-tags" aria-hidden="true"></i> 标签</a></li><li><a href="/categories/%E6%8A%80%E6%9C%AF/"><i class="fa fa-code" aria-hidden="true"></i> 技术</a></li><li><a href="/categories/%E7%94%9F%E6%B4%BB/"><i class="fa fa-file-text-o" aria-hidden="true"></i> 生活</a></li></ul></li><li><a href="javascript:;"><span class="faa-parent animated-hover"><i class="fa fa-list-ul faa-vertical" aria-hidden="true"></i> 清单</span></a><ul class="sub-menu"><li><a href="/photos/"><i class="fa fa-photo" aria-hidden="true"></i> 相册</a></li><li><a href="/shuoshuo/"><i class="fa fa-commenting-o fa-commenting" aria-hidden="true"></i> 说说</a></li><li><a href="/bangumi/"><i class="fa fa-film faa-vertical" aria-hidden="true"></i> 番组</a></li><li><a href="/music/"><i class="fa fa-headphones" aria-hidden="true"></i> 歌单</a></li></ul></li><li><a href="/comment/"><span class="faa-parent animated-hover"><i class="fa fa-pencil-square-o faa-tada" aria-hidden="true"></i> 留言板</span></a></li><li><a href="/links/"><span class="faa-parent animated-hover"><i class="fa fa-link faa-shake" aria-hidden="true"></i> 友人帐</span></a></li><li><a href="/donate/"><span class="faa-parent animated-hover"><i class="fa fa-heart faa-pulse" aria-hidden="true"></i> 赞赏</span></a></li><li><a href="/"><span class="faa-parent animated-hover"><i class="fa fa-leaf faa-wrench" aria-hidden="true"></i> 关于</span></a><ul class="sub-menu"><li><a href="/about/"><i class="fa fa-meetup" aria-hidden="true"></i> 我？</a></li><li><a href="/theme-sakura/"><i class="fa iconfont icon-sakura" aria-hidden="true"></i> 主题</a></li><li><a href="/lab/"><i class="fa fa-cogs" aria-hidden="true"></i> Lab</a></li></ul></li><li><a href="/client/"><span class="faa-parent animated-hover"><i class="fa fa-android faa-vertical" aria-hidden="true"></i> 项目</span></a></li><li><a href="/atom.xml"><span class="faa-parent animated-hover"><i class="fa fa-rss faa-pulse" aria-hidden="true"></i> RSS</span></a></li></ul><p style="text-align:center;font-size:13px;color:#b9b9b9">&copy 2020 hexo-sakura</p></div><button onclick="topFunction()" class="mobile-cd-top" id="moblieGoTop" title="Go to top" style="display:none"><i class="fa fa-chevron-up" aria-hidden="true"></i></button><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><style>.aplayer .aplayer-lrc{height:35px}.aplayer .aplayer-lrc p{font-size:16px;font-weight:700;line-height:18px!important}.aplayer .aplayer-lrc p.aplayer-lrc-current{color:#FF1493}.aplayer.aplayer-narrow .aplayer-body{left:-66px!important}.aplayer.aplayer-fixed .aplayer-lrc{display:none}.aplayer .aplayer-lrc.aplayer-lrc-hide{display:none!important}.aplayer.aplayer-fixed .lrc-show{display:block;background:rgba(255,255,255,.8)}</style><meting-js id="2660651585" server="netease" type="playlist" fixed="true" autoplay loop order="random" preload="auto" volume="0.7" mutex="true"></meting-js><script>$(function(){$("body").on("click",".aplayer",function(){$(".aplayer-button").hasClass("aplayer-play")?$(".aplayer-lrc").removeClass("lrc-show"):$(".aplayer-lrc").addClass("lrc-show")})})</script></body><!-- rebuild by neat -->